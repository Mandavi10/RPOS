var OrderTypeid = "", restroid = 0, neworderid = 0, orderid = 0, Rownumber = ""; function getordertypeid(e) { jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/BindOrderType", data: "{'OrderType':'" + e + "'}", dataType: "json", async: !1, success: function (t) { OrderTypeid = e = t } }) } function getorderid(e) { jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/BindOrderidtakeaway", data: "{'neworder':'" + e + "'}", dataType: "json", async: !1, success: function (t) { neworderid = e = t } }) } function BindMenu() { restroid = jquery_min_p("#lblrestroid").text(), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/MenuCreation/BindMenu", data: "{'restroid':'" + restroid + "'}", dataType: "json", async: !1, success: function (result) { for (var i = 0, jsondata = eval(result), i = 0; i < result.length; i++) { var newOption = $("<option>"); newOption.attr("value", result[i].RestroMenuId).text(result[i].Name), 1 == result[i].IsCurrent && newOption.attr("selected", "selected"), $("#ddlselectmenu").append(newOption) } } }) } function BindLevel() { jquery_min_p("#divlevel1").html(""), jquery_min_p("#divlevel2").html(""), jquery_min_p("#divlevel3").html(""), jquery_min_p("#divitemlist").html(""); jquery_min_p("#ddlselectmenu option:selected").text(); var e = jquery_min_p("#ddlselectmenu").val(); restroid = jquery_min_p("#lblrestroid").text(), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/MenuCreation/BindLevel1", data: "{'restroid':'" + restroid + "','restromenuid':'" + e + "'}", dataType: "json", async: !1, success: function (e) { var t = 0, n = e.length, i = ""; for (t = 0; t < n; t++) i = (i = i + "<div class='item'><div class='MenuBoxtopdiv' id='level1_" + e[t].RestroMenuLevel1Id + "' onclick='BindLevel1(" + e[t].RestroMenuLevel1Id + ")'>") + " <h6>" + e[t].name + "</h6>", i += "</div></div>"; jquery_min_p("#divlevel1").append(i), ResCarouselSize(), jquery_min_p("#preloader").css("display", "none"), jquery_min_p("#Overlay_Load").css("visibility", "hidden") }, beforesend: function () { jquery_min_p("#preloader").css("display", "block"), jquery_min_p("#Overlay_Load").css("visibility", "visible") } }) } function BindLevel1(e) { jquery_min_p("#divlevel1 .MenuBoxtopdiv").removeClass("active"), level1id = "#level1_" + e, jquery_min_p(level1id).removeClass("active"), jquery_min_p(level1id).addClass("active"), jquery_min_p("#divitemlist").html(""); var t = jquery_min_p("#ddlselectmenu").val(); restroid = jquery_min_p("#lblrestroid").text(), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/MenuCreation/BindItemLevel1", data: "{'restroid':'" + restroid + "','restromenuid':'" + t + "','RestroMenuLevel1Id':'" + e + "'}", dataType: "json", async: !1, success: function (n) { var i = 0, r = "", d = n.length; if (d > 0) { for (i = 0; i < d; i++) r = (r = r + "<div class='MenuBox' id='" + n[i].RestroMenuItemId + "' onclick='SelectedItem(" + n[i].RestroMenuItemId + ',"' + n[i].itemId + "\")'>") + "<h6>" + n[i].itemname + "</h6>", r += "</div>"; jquery_min_p("#divitemlist").append(r) } jquery_min_p("#divlevel2").html(""), jquery_min_p("#divlevel3").html(""), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/MenuCreation/BindLevel2", data: "{'restroid':'" + restroid + "','restromenuid':'" + t + "','RestroMenuLevel1Id':'" + e + "'}", dataType: "json", async: !1, success: function (e) { var t = ""; if (e.length > 0) { for (var n = e.length, i = 0; i < n; i++) t = (t = t + "<div class='item'><div class='leveltwobox' id='level2_" + e[i].RestroMenuLevel2Id + "' onclick='BindItemLevel2(" + e[i].RestroMenuLevel2Id + ")'>") + " <h6>" + e[i].name + "</h6>", t += "</div></div>"; jquery_min_p("#divlevel2").append(t) } ResCarouselSize() } }) } }) } function BindItemLevel2(e) { jquery_min_p("#divlevel2 .leveltwobox").removeClass("active"), level2id = "#level2_" + e, jquery_min_p(level2id).removeClass("active"), jquery_min_p(level2id).addClass("active"), jquery_min_p("#divitemlist").html(""); var t = jquery_min_p("#ddlselectmenu").val(); restroid = jquery_min_p("#lblrestroid").text(), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/MenuCreation/BindItemLevel2", data: "{'restroid':'" + restroid + "','restromenuid':'" + t + "','RestroMenuLevel2Id':'" + e + "'}", dataType: "json", async: !1, success: function (n) { var i = 0, r = "", d = n.length; if (d > 0) { for (i = 0; i < d; i++) r = (r = r + "<div class='MenuBox' id='" + n[i].RestroMenuItemId + "' onclick='SelectedItem(" + n[i].RestroMenuItemId + ")'>") + "<h6>" + n[i].itemname + "</h6>", r += "</div>"; jquery_min_p("#divitemlist").append(r) } jquery_min_p("#divlevel3").html(""), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/MenuCreation/BindLevel3", data: "{'restroid':'" + restroid + "','restromenuid':'" + t + "','RestroMenuLevel2Id':'" + e + "'}", dataType: "json", async: !1, success: function (e) { var t = ""; if (e.length > 0) { for (var n = e.length, i = 0; i < n; i++) t = (t = t + "<div class='item'><div class='levelthreebox' id='level3_" + e[i].RestroMenuLevel3Id + "' onclick='BindItemLevel3(" + e[i].RestroMenuLevel3Id + ")'>") + " <h6>" + e[i].name + "</h6>", t += "</div></div>"; jquery_min_p("#divlevel3").append(t) } ResCarouselSize() } }) } }) } function BindItemLevel3(e) { jquery_min_p("#divlevel3 .levelthreebox").removeClass("active"), level3id = "#level3_" + e, jquery_min_p(level3id).removeClass("active"), jquery_min_p(level3id).addClass("active"), jquery_min_p("#divitemlist").html(""); var t = jquery_min_p("#ddlselectmenu").val(); restroid = jquery_min_p("#lblrestroid").text(), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/MenuCreation/BindItemLevel3", data: "{'restroid':'" + restroid + "','restromenuid':'" + t + "','RestroMenuLevel3Id':'" + e + "'}", dataType: "json", async: !1, success: function (e) { var t = 0, n = "", i = e.length; if (i > 0) { for (t = 0; t < i; t++) n = (n = n + "<div class='MenuBox' id='" + e[t].RestroMenuItemId + "' onclick='SelectedItem(" + e[t].RestroMenuItemId + ',"' + e[t].itemId + "\")'>") + "<h6>" + e[t].itemname + "</h6>", n += "</div>"; jquery_min_p("#divitemlist").append(n) } } }), 0 == neworderid && gettemporder() } function SelectedItem(e, t) { "" == neworderid && (neworderid = 0), selitemid = t, jquery_min_p("#divitemlist .MenuBox").removeClass("active"), jquery_min_p("#txtQty").text(1); var n = "#" + e; jquery_min_p(n).removeClass("active"), jquery_min_p(n).addClass("active"), jquery_min_p("#lblrestromenuitemid").text(e), jquery_min_p("#lblitemid").text(selitemid), jquery_min_p("#destinationFields").html(""), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/BindItemAddons", data: "{'restroid':'" + restroid + "','itemid':'" + selitemid + "','orderid':'" + orderid + "','neworderid':'" + neworderid + "'}", dataType: "json", async: !1, success: function (e) { var t = 0, n = "", i = e.length; if (i > 0) { for (t = 0; t < i; t++) n = (n = n + "<div class='MenuBox' id='" + e[t].addonsId + "' onclick='GetSelectedAddons(" + e[t].addonsId + ")'>") + "<h6>" + e[t].name + "</h6>", n += "</div>"; bootstrap_min_p("#Addons").modal("show"), jquery_min_p("#btnaddonok").css("display", "none"), jquery_min_p("#btnconfirm").css("display", "inline-block"), jquery_min_p("#destinationFields").append(n), jquery_min_p("#destinationFields .MenuBox").each(function () { for (t = 0; t < i; t++) if (null != e[t].seladdon) { var n = jquery_min_p(this).attr("id"); e[t].addonsId == n && jquery_min_p("#" + n).addClass("selectedItem") } }) } } }) } function GetSelectedAddons(e) { var t = "#" + e; jquery_min_p(t).hasClass("selectedItem") ? jquery_min_p(t).removeClass("selectedItem") : jquery_min_p(t).addClass("selectedItem"), jquery_min_p("#btnaddonok").css("display", "block"), jquery_min_p("#btnconfirm").css("display", "none") } function IncQty() { "" == neworderid && (neworderid = 0); var e = jquery_min_p("#lblrestromenuitemid").text(), t = jquery_min_p("#lblitemid").text(), n = 0; n = parseInt(jquery_min_p("#txtQty").text()), n += 1, jquery_min_p("#txtQty").text(n), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/UpdateQty", data: "{'restroid':'" + restroid + "','RestroMenuItemId':'" + e + "','orderid':'" + orderid + "','Qty':'" + n + "','neworderid':'" + neworderid + "','itemId':'" + t + "'}", dataType: "json", async: !1, success: function (e) { BindItemTable() } }) } function DecQty() { "" == neworderid && (neworderid = 0); var e = jquery_min_p("#lblrestromenuitemid").text(), t = jquery_min_p("#lblitemid").text(), n = 0; (n = parseInt(jquery_min_p("#txtQty").text())) > 1 && (n -= 1), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/UpdateQty", data: "{'restroid':'" + restroid + "','RestroMenuItemId':'" + e + "','orderid':'" + orderid + "','Qty':'" + n + "','neworderid':'" + neworderid + "','itemId':'" + t + "'}", dataType: "json", async: !1, success: function (e) { BindItemTable() } }) } function IncQtyTable(e, t, n, i) { "" == neworderid && (neworderid = 0); var r = 0, d = jquery_min_p(e).closest("tr"); r = parseInt(d.find("td:nth-child(4)").text().trim()), r += 1, jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/UpdateQty", data: "{'restroid':'" + restroid + "','RestroMenuItemId':'" + t + "','orderid':'" + orderid + "','Qty':'" + r + "','neworderid':'" + neworderid + "','itemId':'" + n + "','Rownumber':'" + i + "'}", dataType: "json", async: !1, success: function (e) { BindItemTable() } }) } function DecQtyTable(e, t, n, i) { "" == neworderid && (neworderid = 0); var r = 0, d = jquery_min_p(e).closest("tr"); (r = parseInt(d.find("td:nth-child(4)").text().trim())) > 1 && (r -= 1), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/UpdateQty", data: "{'restroid':'" + restroid + "','RestroMenuItemId':'" + t + "','orderid':'" + orderid + "','Qty':'" + r + "','neworderid':'" + neworderid + "','itemId':'" + n + "','Rownumber':'" + i + "'}", dataType: "json", async: !1, success: function (e) { BindItemTable() } }) } function BindItem() { "" == neworderid && (neworderid = 0); var e = jquery_min_p("#lblrestromenuitemid").text(), t = jquery_min_p("#lblitemid").text(); restroid = jquery_min_p("#lblrestroid").text(); var n = jquery_min_p("#txtQty").text(), i = jquery_min_p("#txtMember").text(), r = "<dtXml>"; jquery_min_p("#divitemlist .MenuBox").each(function (e) { if (jquery_min_p(this).hasClass("active")) { r += "<dtXml "; jquery_min_p(this)[0].id; r += 'addonId="0" ', r += 'selitemid="' + selitemid + '" ', r += " />" } }), r += "</dtXml>", jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/SaveItemAddon", data: "{'TableDataX':'" + r + "','restroid':'" + restroid + "','orderid':'" + orderid + "','restromenuitemid':'" + e + "','Qty':'" + n + "','neworderid':'" + neworderid + "','Member':'" + i + "','itemId':'" + t + "'}", dataType: "json", async: !1, success: function (e) { BindItemTable() } }) } function BindTable() { "" == neworderid && (neworderid = 0), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/BindTable", data: "{'orderid':'" + orderid + "','restroid':'" + restroid + "','neworderid':'" + neworderid + "'}", dataType: "json", async: !1, success: function (e) { if (e.length > 0) { var t = e[0].tablename; jquery_min_p("#lbltableid").text(t) } } }) } function defaultMenu() { restroid = jquery_min_p("#lblrestroid").text(), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/MenuCreation/defaultMenu", data: "{'restroid':'" + restroid + "'}", dataType: "json", async: !1, success: function (e) { } }), BindLevel() } function DeleteItem(e, t, n, i) { jquery_min_p("#hconfirmdel").text("Are You Sure to Delete Item ??"), bootstrap_min_p("#deletePopup1").modal("show"), deletedata = e, restroitemid = t, itemId = n, Rownumber = i } function Delete() { "" == neworderid && (neworderid = 0), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/DeleteData", data: "{'restroitemid':'" + restroitemid + "','restroid':'" + restroid + "','orderid':'" + orderid + "','neworderid':'" + neworderid + "','itemId':'" + itemId + "','Rownumber':'" + Rownumber + "'}", dataType: "json", async: !1, success: function (e) { e.length > 0 && (jquery_min_p("#popupsuccess").text("Item Deleted Successfully"), bootstrap_min_p("#savePopup").modal("show"), BindItemTable()) } }) } function SaveItemAddon() { "" == neworderid && (neworderid = 0), updateorderdetails = []; var e = jquery_min_p("#lblrestromenuitemid").text(), t = jquery_min_p("#lblitemid").text(), n = "<dtXml>"; jquery_min_p("#destinationFields .MenuBox").each(function (e) { if (jquery_min_p(this).hasClass("selectedItem")) { n += "<dtXml "; var t = jquery_min_p(this)[0].id; n += 'addonId="' + t + '" ', n += 'selitemid="' + selitemid + '" ', n += " />", updateorderdetails.push(t) } }), n += "</dtXml>"; jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/SaveItemAddon", data: "{'TableDataX':'" + n + "','restroid':'" + restroid + "','orderid':'" + orderid + "','restromenuitemid':'" + e + "','Qty':'1','neworderid':'" + neworderid + "','Member':'0','itemId':'" + t + "'}", dataType: "json", async: !1, success: function (e) { BindItemTable() } }) } function BindAddons(e, t, n) { "" == neworderid && (neworderid = 0), updateorderdetails = [], jquery_min_p("#destinationFields").html(""), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/BindAddons", data: "{'restroid':'" + restroid + "','RestroMenuItemId':'" + e + "','orderid':'" + orderid + "','neworderid':'" + neworderid + "','Itemid':'" + t + "','Rownumber':'" + n + "'}", dataType: "json", async: !1, success: function (e) { if (e.length > 0) { for (var t = "", n = e.length, i = 0; i < n; i++) t = (t = t + "<div class='MenuBox' id='" + e[i].addonsId + "'>") + "<h6>" + e[i].name + "</h6>", t += "</div>"; bootstrap_min_p("#Addons").modal("show"), jquery_min_p("#btnaddonok").css("display", "none"), jquery_min_p("#destinationFields").append(t) } } }) } function BindItemTable() { "" == neworderid && (neworderid = 0), jquery_min_p("#tblItemlist tbody").html(""), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/BindItemList", data: "{'restroid':'" + restroid + "','orderid':'" + orderid + "','neworderid':'" + neworderid + "'}", dataType: "json", async: !1, success: function (e) { var t = 0, n = e.Table; if (n.length > 0) { var i = n.length; for (t = 0; t < i; t++) { var r; r = (r = (r = (r = (r = (r = (r = (r = (r = r + "<tr>") + "<td style='display:none'> " + n[t].itemId + " </td>") + "<td width='22%'> " + n[t].ItemName + " </td>") + "<td> " + n[t].itemPrice + "</td>") + "<td> " + n[t].Qty + "</td>") + "<td>" + n[t].KOTId + "</td>") + "<td ><i class='fa fa-plus-circle' aria-hidden='true' onclick='IncQtyTable(this," + n[t].RestroMenuItemId + ',"' + n[t].itemId + '","' + n[t].rownumber + "\")'></i></td>") + "<td><i class='fa fa-minus-circle' aria-hidden='true' onclick='DecQtyTable(this," + n[t].RestroMenuItemId + ',"' + n[t].itemId + '","' + n[t].rownumber + "\")'></i></td>") + "<td><i class='fa fa-trash-o' onclick='DeleteItem(this," + n[t].RestroMenuItemId + ',"' + n[t].itemId + '","' + n[t].rownumber + "\")'></i></td>", null != n[t].AddonsId ? r = r + "<td ><i class='fa fa-plus' aria-hidden='true' onclick='BindAddons(" + n[t].RestroMenuItemId + ',"' + n[t].itemId + '","' + n[t].rownumber + "\")'></i></td>" : r += "<td ></td>", r += "</tr>" } jquery_min_p("#tblItemlist tbody").append(r), jquery_min_p("#btnconfirm").css("display", "inline-block") } t = 0; if (n = e.Table1, jquery_min_p("#lblSAR").text(n[t].SAR), jquery_min_p("#lblbill").text(n[t].TotalAmount), jquery_min_p("#lbltax").text(n[t].TaxAmount), 0 != neworderid) { t = 0; (n = e.Table2).length > 0 && (jquery_min_p("#ddlselectmenu").val(n[t].RestroMenuId), jquery_min_p("#lblorderno").text(n[t].orderno), jquery_min_p("#txtMember").text(n[t].MemberNo)) } } }) } function ResCarouselSize() { var e = "", t = 0, n = 0, i = "", r = "", d = $(".MultiCarousel").width(), a = $("body").width(); $(".MultiCarousel-inner").each(function () { n += 1; var o = $(this).find(".item").length; i = $(this).parent().attr("data-items"), r = i.split(","), $(this).parent().attr("id", "MultiCarousel" + n), $(this).parent().attr("id", "MultiCarousel1" + n), $(this).parent().attr("id", "MultiCarousel2" + n), a >= 1200 ? (t = r[3], e = d / t) : a >= 992 ? (t = r[2], e = d / t) : a >= 768 ? (t = r[1], e = d / t) : (t = r[0], e = d / t), $(this).css({ transform: "translateX(0px)", width: e * o }), $(this).find(".item").each(function () { $(this).outerWidth(e) }), $(".leftLst").addClass("over"), $(".rightLst").removeClass("over") }) } function SaveOrder() { if (0 == neworderid) { neworderid = 0; var e = jquery_min_p("#ddlselectmenu option:selected").val(); jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/SaveOrder", data: "{'restromenuid':'" + e + "','restroid':'" + restroid + "','orderid':'" + orderid + "','neworderid':'" + neworderid + "','OrderType':'" + OrderTypeid + "'}", dataType: "json", async: !1, success: function (e) { var t = e.Table; jquery_min_p("#lblorderno").text(t[0].orderno), jquery_min_p("#popupsuccess1").text("Order Saved Successfully"), bootstrap_min_p("#savesuccessPopup").modal("show") } }) } else jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/updateorderstatus", data: "{'restroid':'" + restroid + "','neworderid':'" + neworderid + "'}", dataType: "json", async: !1, success: function (e) { e.Table; jquery_min_p("#popupsuccess1").text("Order Saved Successfully"), bootstrap_min_p("#savesuccessPopup").modal("show") } }) } function gettemporder() { restroid = jquery_min_p("#lblrestroid").text(), jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/gettemporder", data: "{'OrderType':'" + OrderTypeid + "','restroid':'" + restroid + "'}", dataType: "json", async: !1, success: function (e) { orderid = e[0].temporderno } }) } function ClearOrder() { jquery_min_p.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: "/DineInTakeAway/clearorder", data: "{'restroid':'" + restroid + "','orderid':'" + orderid + "'}", dataType: "json", async: !1, success: function (e) { BindItemTable(), jquery_min_p("#popupsuccess").text("Order Cleared Successfully"), bootstrap_min_p("#savePopup").modal("show") } }) } jquery_min_p(document).ready(function () { restroid = jquery_min_p("#lblrestroid").text(); const e = new URLSearchParams(window.location.search), t = e.get("OrderTypeId"); null != t && getordertypeid(t); new URLSearchParams(window.location.search); const n = e.get("orderId"); null != n && getorderid(n), BindMenu(), defaultMenu(), null != n ? (BindItemTable(), jquery_min_p("#btnclrorder").css("display", "none")) : jquery_min_p("#btnclrorder").css("display", "inline-block"), jquery_min_p("#btnconfirm").click(function () { BindItem(), jquery_min_p("#btnsaveorder").css("display", "inline-block") }), jquery_min_p("#btnsaveorder").click(function () { SaveOrder(), jquery_min_p("#btnclrorder").css("display", "none") }), jquery_min_p("#delsucess").click(function () { Delete(), bootstrap_min_p("#deletePopup1").modal("hide") }), jquery_min_p("#delcancel").click(function () { bootstrap_min_p("#deletePopup1").modal("hide") }), jquery_min_p("#btnaddonok").click(function () { SaveItemAddon(), jquery_min_p("#btnsaveorder").css("display", "inline-block") }), jquery_min_p("#btnsaveok").click(function () { window.location.href = "/SalesBilling/RunningOrder" }), jquery_min_p("#btnclrorder").click(function () { ClearOrder(), jquery_min_p("#btnsaveorder").css("display", "none") }) });